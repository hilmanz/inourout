(function(e,t,n,r){"use strict";e.ajax_scroll=function(r,i){this.settings=e.extend({},e.ajax_scroll.defaults,i),this._validate(this.settings),this.timerInterval=-1,this.lastDocHeight=0,this.proccesingCallback=!1,this.lastScrollPosition=0,this.lastHtmlLength=e(this.settings.targetElement).html().length,this.instanceID="paged_scroll"+Math.round(Math.random()*9999999999);var s=this,o=function(i){return function(){i.settings.useScrollOptimization?i.timerInterval===-1&&(i._debug("Setting timeout:",i.settings.checkScrollChange),i.timerInterval=setTimeout(function(){i._checkScroll(r,e,t,n,i.settings),i.timerInterval=-1},i.settings.checkScrollChange)):i._checkScroll(r,e,t,n,i.settings)}}(s);e(r).on("scroll",o)},e.ajax_scroll.defaults={handleScroll:function(e,t,n){return!0},triggerFromBottom:"10%",loading:{html:'<div><img src="'+basedomain+'assets/images/loader.gif" alt="Loading..."></div>'},targetElement:null,startPage:0,pagesToScroll:null,beforePageChanged:function(e,t){return!0},afterPageChanged:function(e,t){return!0},useScrollOptimization:!0,checkScrollChange:500,monitorChangeInterval:300,monitorTargetChange:!0,debug:!1},e.ajax_scroll.prototype={_calculateStep:function(e){return e.triggerFromBottom.toString().indexOf("%")>-1?parseFloat(e.triggerFromBottom.replace("%","")):parseFloat(e.triggerFromBottom)},_validate:function(t){var n=this._calculateStep(t);if(isNaN(n))throw"Step need to be provided as number or percentage,50 or 5% fro percent for example";if(!t.targetElement||e(t.targetElement).length===0)throw"Please provide the selector of target element.(Element where you finally insert the new content)"},_checkCallbackDone:function(t,n){this._debug("Checking target html for change...");if(t.monitorTargetChange&&e(t.targetElement).is(":visible")){var r=e(t.targetElement).html().length;if(r!==this.lastHtmlLength)this._debug("Html is changed"),this.lastHtmlLength=r,this.proccesingCallback=!1,e(n).hide();else{var i=this;this._debug("Html is not changed.Check later"),setTimeout(function(){i._checkCallbackDone.call(i,i.settings,n)},i.settings.monitorChangeInterval)}}},_getScrollData:function(e,t,n,r,i,s){var o=parseFloat(e(t).height()),u=parseFloat(e(t).scrollTop()),a=t.self===n,f=a?parseFloat(e(r).height()):o,l=f/i._calculateStep(s);return{elemHeight:o,elemScroll:u,isWindow:a,docHeight:f,step:l}},_checkScroll:function(e,t,n,r,i){this._debug("Checking scroll on  : "+this.instanceID);var s=this;if(i.targetElement&&!t(i.targetElement).is(":visible")){s._debug("Ignoring the call because target element is not  visible.Exit scroll check ..");return}if(s.proccesingCallback){s._debug("Processing callback.Exit...");return}var o=s._getScrollData(t,e,n,r,s,i),u=o.elemHeight,a=o.elemScroll,f=o.isWindow,l=o.docHeight,c=o.step;s._debug(["Elem height : ",u,".Elem scroll :",a,".Step is :",c,".DocHeight :",l,".Last element height:",s.lastDocHeight].join(""));var h=f?u+a+c:a+c;s._debug("Position:"+h+".Last position:"+s.lastScrollPosition+".Last element height:"+s.lastDocHeight);var p=h>s.lastScrollPosition,d=!i.pagesToScroll||i.pagesToScroll&&i.startPage<i.pagesToScroll;if(h>=l&&p&&d){this.lastScrollPosition=h,this.lastDocHeight=l,i.startPage=i.startPage+1,i.beforePageChanged(i.startPage,e),s._debug("Calling 'handleScroll' callback"),s.proccesingCallback=!0;var v=t(s.settings.loading.html).appendTo(t(s.settings.targetElement));s.lastHtmlLength=t(i.targetElement).html().length,i.handleScroll(i.startPage,e,function(){s._debug("Callback done."),s.proccesingCallback=!1,v.hide()}),s._checkCallbackDone.call(s,s.settings,v),i.afterPageChanged(i.startPage,e)}},_debug:function(){try{if(!this.settings.debug)return;typeof console!="undefined"&&typeof console.log=="function"?Array.prototype.slice.call(arguments).length===1&&typeof Array.prototype.slice.call(arguments)[0]=="string"?console.log(Array.prototype.slice.call(arguments).toString()):console.log(Array.prototype.slice.call(arguments)):!Function.prototype.bind&&typeof console!="undefined"&&typeof console.log=="object"&&Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))}catch(e){}}},e.fn.paged_scroll=function(t){return this.each(function(){var n=new e.ajax_scroll(this,t);e.data(this,"jqueryPagedScroll",n)})}})(jQuery,window,document);